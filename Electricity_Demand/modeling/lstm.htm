<!DOCTYPE html>
<!-- saved from url=(0043)http://localhost:8888/notebooks/lstm.ipynb# -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    

    <title>lstm</title>
    <link rel="shortcut icon" type="image/x-icon" href="http://localhost:8888/static/base/images/favicon.ico?v=30780f272ab4aac64aa073a841546240">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <link rel="stylesheet" href="./lstm_files/jquery-ui.min.css" type="text/css">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    
    


<script type="text/javascript" src="./lstm_files/MathJax.js" charset="utf-8"></script>

<script type="text/javascript">
// MathJax disabled, set as null to distingish from *missing* MathJax,
// where it will be undefined, and should prompt a dialog later.
window.mathjax_url = "/static/components/MathJax/MathJax.js";
</script>

<link rel="stylesheet" href="./lstm_files/bootstrap-tour.min.css" type="text/css">
<link rel="stylesheet" href="./lstm_files/codemirror.css">


    <link rel="stylesheet" href="./lstm_files/style.min.css" type="text/css">
    

<link rel="stylesheet" href="./lstm_files/override.css" type="text/css">
<link rel="stylesheet" href="http://localhost:8888/notebooks/lstm.ipynb" id="kernel-css" type="text/css">


    <link rel="stylesheet" href="./lstm_files/custom.css" type="text/css">
    <script src="./lstm_files/promise.min.js" type="text/javascript" charset="utf-8"></script>
    <script src="./lstm_files/require.js" type="text/javascript" charset="utf-8"></script>
    <script>
      require.config({
          
          urlArgs: "v=20181124140050",
          
          baseUrl: '/static/',
          paths: {
            'auth/js/main': 'auth/js/main.min',
            custom : '/custom',
            nbextensions : '/nbextensions',
            widgets : '/deprecatedwidgets',
            kernelspecs : '/kernelspecs',
            underscore : 'components/underscore/underscore-min',
            backbone : 'components/backbone/backbone-min',
            jquery: 'components/jquery/jquery.min',
            bootstrap: 'components/bootstrap/js/bootstrap.min',
            bootstraptour: 'components/bootstrap-tour/build/js/bootstrap-tour.min',
            jqueryui: 'components/jquery-ui/ui/minified/jquery-ui.min',
            moment: 'components/moment/moment',
            codemirror: 'components/codemirror',
            termjs: 'components/term.js/src/term',
          },
          shim: {
            underscore: {
              exports: '_'
            },
            backbone: {
              deps: ["underscore", "jquery"],
              exports: "Backbone"
            },
            bootstrap: {
              deps: ["jquery"],
              exports: "bootstrap"
            },
            bootstraptour: {
              deps: ["bootstrap"],
              exports: "Tour"
            },
            jqueryui: {
              deps: ["jquery"],
              exports: "$"
            }
          }
      });

      require.config({
          map: {
              '*':{
                'contents': 'services/contents',
              }
          }
      });
    </script>

    
    

<script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="services/contents" src="./lstm_files/contents.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="custom/custom" src="./lstm_files/custom.js"></script><style type="text/css">.MathJax_Hover_Frame {border-radius: .25em; -webkit-border-radius: .25em; -moz-border-radius: .25em; -khtml-border-radius: .25em; box-shadow: 0px 0px 15px #83A; -webkit-box-shadow: 0px 0px 15px #83A; -moz-box-shadow: 0px 0px 15px #83A; -khtml-box-shadow: 0px 0px 15px #83A; border: 1px solid #A6D ! important; display: inline-block; position: absolute}
.MathJax_Hover_Arrow {position: absolute; width: 15px; height: 11px; cursor: pointer}
</style><style type="text/css">#MathJax_About {position: fixed; left: 50%; width: auto; text-align: center; border: 3px outset; padding: 1em 2em; background-color: #DDDDDD; color: black; cursor: default; font-family: message-box; font-size: 120%; font-style: normal; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 15px; -webkit-border-radius: 15px; -moz-border-radius: 15px; -khtml-border-radius: 15px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_Menu {position: absolute; background-color: white; color: black; width: auto; padding: 5px 0px; border: 1px solid #CCCCCC; margin: 0; cursor: default; font: menu; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; z-index: 201; border-radius: 5px; -webkit-border-radius: 5px; -moz-border-radius: 5px; -khtml-border-radius: 5px; box-shadow: 0px 10px 20px #808080; -webkit-box-shadow: 0px 10px 20px #808080; -moz-box-shadow: 0px 10px 20px #808080; -khtml-box-shadow: 0px 10px 20px #808080; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
.MathJax_MenuItem {padding: 1px 2em; background: transparent}
.MathJax_MenuArrow {position: absolute; right: .5em; color: #666666}
.MathJax_MenuActive .MathJax_MenuArrow {color: white}
.MathJax_MenuArrow.RTL {left: .5em; right: auto}
.MathJax_MenuCheck {position: absolute; left: .7em}
.MathJax_MenuCheck.RTL {right: .7em; left: auto}
.MathJax_MenuRadioCheck {position: absolute; left: .7em}
.MathJax_MenuRadioCheck.RTL {right: .7em; left: auto}
.MathJax_MenuLabel {padding: 1px 2em 3px 1.33em; font-style: italic}
.MathJax_MenuRule {border-top: 1px solid #DDDDDD; margin: 4px 3px}
.MathJax_MenuDisabled {color: GrayText}
.MathJax_MenuActive {background-color: #606872; color: white}
.MathJax_Menu_Close {position: absolute; width: 31px; height: 31px; top: -15px; left: -15px}
</style><style type="text/css">.MathJax_Preview .MJXc-math {color: inherit!important}
</style><style type="text/css">#MathJax_Zoom {position: absolute; background-color: #F0F0F0; overflow: auto; display: block; z-index: 301; padding: .5em; border: 1px solid black; margin: 0; font-weight: normal; font-style: normal; text-align: left; text-indent: 0; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; box-shadow: 5px 5px 15px #AAAAAA; -webkit-box-shadow: 5px 5px 15px #AAAAAA; -moz-box-shadow: 5px 5px 15px #AAAAAA; -khtml-box-shadow: 5px 5px 15px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true')}
#MathJax_ZoomOverlay {position: absolute; left: 0; top: 0; z-index: 300; display: inline-block; width: 100%; height: 100%; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
#MathJax_ZoomFrame {position: relative; display: inline-block; height: 0; width: 0}
#MathJax_ZoomEventTrap {position: absolute; left: 0; top: 0; z-index: 302; display: inline-block; border: 0; padding: 0; margin: 0; background-color: white; opacity: 0; filter: alpha(opacity=0)}
</style><style type="text/css">.MathJax_Preview {color: #888}
#MathJax_Message {position: fixed; left: 1em; bottom: 1.5em; background-color: #E6E6E6; border: 1px solid #959595; margin: 0px; padding: 2px 8px; z-index: 102; color: black; font-size: 80%; width: auto; white-space: nowrap}
#MathJax_MSIE_Frame {position: absolute; top: 0; left: 0; width: 0px; z-index: 101; border: 0px; margin: 0px; padding: 0px}
.MathJax_Error {color: #CC0000; font-style: italic}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/notebook/js/extension" src="./lstm_files/extension.js"></script><style type="text/css">.MJXc-script {font-size: .8em}
.MJXc-right {-webkit-transform-origin: right; -moz-transform-origin: right; -ms-transform-origin: right; -o-transform-origin: right; transform-origin: right}
.MJXc-bold {font-weight: bold}
.MJXc-italic {font-style: italic}
.MJXc-scr {font-family: MathJax_Script,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-frak {font-family: MathJax_Fraktur,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-sf {font-family: MathJax_SansSerif,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-cal {font-family: MathJax_Caligraphic,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-mono {font-family: MathJax_Typewriter,'Times New Roman',Times,STIXGeneral,serif}
.MJXc-largeop {font-size: 150%}
.MJXc-largeop.MJXc-int {vertical-align: -.2em}
.MJXc-math {display: inline-block; line-height: 1.2; text-indent: 0; font-family: 'Times New Roman',Times,STIXGeneral,serif; white-space: nowrap; border-collapse: collapse}
.MJXc-display {display: block; text-align: center; margin: 1em 0}
.MJXc-math span {display: inline-block}
.MJXc-box {display: block!important; text-align: center}
.MJXc-box:after {content: " "}
.MJXc-rule {display: block!important; margin-top: .1em}
.MJXc-char {display: block!important}
.MJXc-mo {margin: 0 .15em}
.MJXc-mfrac {margin: 0 .125em; vertical-align: .25em}
.MJXc-denom {display: inline-table!important; width: 100%}
.MJXc-denom > * {display: table-row!important}
.MJXc-surd {vertical-align: top}
.MJXc-surd > * {display: block!important}
.MJXc-script-box > *  {display: table!important; height: 50%}
.MJXc-script-box > * > * {display: table-cell!important; vertical-align: top}
.MJXc-script-box > *:last-child > * {vertical-align: bottom}
.MJXc-script-box > * > * > * {display: block!important}
.MJXc-mphantom {visibility: hidden}
.MJXc-munderover {display: inline-table!important}
.MJXc-over {display: inline-block!important; text-align: center}
.MJXc-over > * {display: block!important}
.MJXc-munderover > * {display: table-row!important}
.MJXc-mtable {vertical-align: .25em; margin: 0 .125em}
.MJXc-mtable > * {display: inline-table!important; vertical-align: middle}
.MJXc-mtr {display: table-row!important}
.MJXc-mtd {display: table-cell!important; text-align: center; padding: .5em 0 0 .5em}
.MJXc-mtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-mlabeledtr {display: table-row!important}
.MJXc-mlabeledtr > .MJXc-mtd:first-child {padding-left: 0}
.MJXc-mlabeledtr:first-child > .MJXc-mtd {padding-top: 0}
.MJXc-merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MJXc-scale0 {-webkit-transform: scaleX(.0); -moz-transform: scaleX(.0); -ms-transform: scaleX(.0); -o-transform: scaleX(.0); transform: scaleX(.0)}
.MJXc-scale1 {-webkit-transform: scaleX(.1); -moz-transform: scaleX(.1); -ms-transform: scaleX(.1); -o-transform: scaleX(.1); transform: scaleX(.1)}
.MJXc-scale2 {-webkit-transform: scaleX(.2); -moz-transform: scaleX(.2); -ms-transform: scaleX(.2); -o-transform: scaleX(.2); transform: scaleX(.2)}
.MJXc-scale3 {-webkit-transform: scaleX(.3); -moz-transform: scaleX(.3); -ms-transform: scaleX(.3); -o-transform: scaleX(.3); transform: scaleX(.3)}
.MJXc-scale4 {-webkit-transform: scaleX(.4); -moz-transform: scaleX(.4); -ms-transform: scaleX(.4); -o-transform: scaleX(.4); transform: scaleX(.4)}
.MJXc-scale5 {-webkit-transform: scaleX(.5); -moz-transform: scaleX(.5); -ms-transform: scaleX(.5); -o-transform: scaleX(.5); transform: scaleX(.5)}
.MJXc-scale6 {-webkit-transform: scaleX(.6); -moz-transform: scaleX(.6); -ms-transform: scaleX(.6); -o-transform: scaleX(.6); transform: scaleX(.6)}
.MJXc-scale7 {-webkit-transform: scaleX(.7); -moz-transform: scaleX(.7); -ms-transform: scaleX(.7); -o-transform: scaleX(.7); transform: scaleX(.7)}
.MJXc-scale8 {-webkit-transform: scaleX(.8); -moz-transform: scaleX(.8); -ms-transform: scaleX(.8); -o-transform: scaleX(.8); transform: scaleX(.8)}
.MJXc-scale9 {-webkit-transform: scaleX(.9); -moz-transform: scaleX(.9); -ms-transform: scaleX(.9); -o-transform: scaleX(.9); transform: scaleX(.9)}
.MathJax_CHTML .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/widgets/js/init" src="./lstm_files/init.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/notebook/js/widgetarea" src="./lstm_files/widgetarea.js"></script><style type="text/css">.MathJax_Display {text-align: center; margin: 0; position: relative; display: block!important; text-indent: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; width: 100%}
.MathJax .merror {background-color: #FFFF88; color: #CC0000; border: 1px solid #CC0000; padding: 1px 3px; font-style: normal; font-size: 90%}
.MathJax .MJX-monospace {font-family: monospace}
.MathJax .MJX-sans-serif {font-family: sans-serif}
#MathJax_Tooltip {background-color: InfoBackground; color: InfoText; border: 1px solid black; box-shadow: 2px 2px 5px #AAAAAA; -webkit-box-shadow: 2px 2px 5px #AAAAAA; -moz-box-shadow: 2px 2px 5px #AAAAAA; -khtml-box-shadow: 2px 2px 5px #AAAAAA; filter: progid:DXImageTransform.Microsoft.dropshadow(OffX=2, OffY=2, Color='gray', Positive='true'); padding: 3px 4px; z-index: 401; position: absolute; left: 0; top: 0; width: auto; height: auto; display: none}
.MathJax {display: inline; font-style: normal; font-weight: normal; line-height: normal; font-size: 100%; font-size-adjust: none; text-indent: 0; text-align: left; text-transform: none; letter-spacing: normal; word-spacing: normal; word-wrap: normal; white-space: nowrap; float: none; direction: ltr; max-width: none; max-height: none; min-width: 0; min-height: 0; border: 0; padding: 0; margin: 0}
.MathJax img, .MathJax nobr, .MathJax a {border: 0; padding: 0; margin: 0; max-width: none; max-height: none; min-width: 0; min-height: 0; vertical-align: 0; line-height: normal; text-decoration: none}
img.MathJax_strut {border: 0!important; padding: 0!important; margin: 0!important; vertical-align: 0!important}
.MathJax span {display: inline; position: static; border: 0; padding: 0; margin: 0; vertical-align: 0; line-height: normal; text-decoration: none}
.MathJax nobr {white-space: nowrap!important}
.MathJax img {display: inline!important; float: none!important}
.MathJax * {transition: none; -webkit-transition: none; -moz-transition: none; -ms-transition: none; -o-transition: none}
.MathJax_Processing {visibility: hidden; position: fixed; width: 0; height: 0; overflow: hidden}
.MathJax_Processed {display: none!important}
.MathJax_ExBox {display: block!important; overflow: hidden; width: 1px; height: 60ex; min-height: 0; max-height: none}
.MathJax .MathJax_EmBox {display: block!important; overflow: hidden; width: 1px; height: 60em; min-height: 0; max-height: none}
.MathJax .MathJax_HitBox {cursor: text; background: white; opacity: 0; filter: alpha(opacity=0)}
.MathJax .MathJax_HitBox * {filter: none; opacity: 1; background: transparent}
#MathJax_Tooltip * {filter: none; opacity: 1; background: transparent}
@font-face {font-family: MathJax_Blank; src: url('about:blank')}
.MathJax .noError {vertical-align: ; font-size: 90%; text-align: left; color: black; padding: 1px 3px; border: 1px solid}
</style><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/widgets/js/manager" src="./lstm_files/manager.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/widgets/js/widget" src="./lstm_files/widget.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/widgets/js/widget_link" src="./lstm_files/widget_link.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/widgets/js/widget_bool" src="./lstm_files/widget_bool.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/widgets/js/widget_button" src="./lstm_files/widget_button.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/widgets/js/widget_box" src="./lstm_files/widget_box.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/widgets/js/widget_float" src="./lstm_files/widget_float.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/widgets/js/widget_image" src="./lstm_files/widget_image.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/widgets/js/widget_int" src="./lstm_files/widget_int.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/widgets/js/widget_color" src="./lstm_files/widget_color.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/widgets/js/widget_output" src="./lstm_files/widget_output.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/widgets/js/widget_selection" src="./lstm_files/widget_selection.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/widgets/js/widget_selectioncontainer" src="./lstm_files/widget_selectioncontainer.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/widgets/js/widget_string" src="./lstm_files/widget_string.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="nbextensions/widgets/widgets/js/widget_controller" src="./lstm_files/widget_controller.js"></script><script type="text/javascript" charset="utf-8" async="" data-requirecontext="_" data-requiremodule="backbone" src="./lstm_files/backbone-min.js"></script><link rel="stylesheet" type="text/css" href="./lstm_files/widgets.min.css"><style type="text/css">@font-face {font-family: STIXMathJax_Main-italic; src: url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/STIX-Web/woff/STIXMathJax_Main-Italic.woff?rev=2.5.3') format('woff'), url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/STIX-Web/otf/STIXMathJax_Main-Italic.otf?rev=2.5.3') format('opentype')}
</style><style type="text/css">@font-face {font-family: STIXMathJax_Main; src: url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/STIX-Web/woff/STIXMathJax_Main-Regular.woff?rev=2.5.3') format('woff'), url('http://localhost:8888/static/components/MathJax/fonts/HTML-CSS/STIX-Web/otf/STIXMathJax_Main-Regular.otf?rev=2.5.3') format('opentype')}
</style></head>

<body class="notebook_app edit_mode" data-project="" data-base-url="/" data-ws-url="" data-notebook-name="Untitled.ipynb" data-notebook-path="Untitled.ipynb" style=""><div style="visibility: hidden; overflow: hidden; position: absolute; top: 0px; height: 1px; width: auto; padding: 0px; border: 0px; margin: 0px; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal;"><div id="MathJax_Hidden"><br><br><br><br><br><br><br><br><br><br><br><br></div></div><div id="MathJax_Message" style="display: none;"></div>

<noscript>
    <div id='noscript'>
      IPython Notebook requires JavaScript.<br>
      Please enable it to proceed.
  </div>
</noscript>

<div id="header" style="display: block;">
  <div id="header-container" class="container">
  <div id="ipython_notebook" class="nav navbar-brand pull-left"><a href="http://localhost:8888/tree" title="dashboard"><img src="./lstm_files/logo.png" alt="Jupyter Notebook"></a></div>

  
  
  

    <span id="login_widget">
      
    </span>

  

  

  


<span id="save_widget" class="pull-left save_widget">
    <span id="notebook_name" class="filename">lstm</span>
    <span class="checkpoint_status" title="Sat, Nov 24, 2018 4:26 PM">Last Checkpoint: 15 minutes ago</span>
    <span class="autosave_status">(unsaved changes)</span>
</span>

<span id="kernel_logo_widget">
  <img class="current_kernel_logo" src="./lstm_files/logo-64x64.png" style="display: inline;">
</span>


  </div>
  <div class="header-bar"></div>

  
<div id="menubar-container" class="container">
<div id="menubar">
    <div id="menus" class="navbar navbar-default" role="navigation">
        <div class="container-fluid">
            <button type="button" class="btn btn-default navbar-btn navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
              <i class="fa fa-bars"></i>
              <span class="navbar-text">Menu</span>
            </button>
            <p id="kernel_indicator" class="navbar-text indicator_area">
              <span class="kernel_indicator_name">Python 2</span>
              <i id="kernel_indicator_icon" class="kernel_idle_icon" title="Kernel Idle"></i>
            </p>
            <i id="readonly-indicator" class="navbar-text" title="This notebook is read-only" style="display: none;">
                <span class="fa-stack">
                    <i class="fa fa-save fa-stack-1x"></i>
                    <i class="fa fa-ban fa-stack-2x text-danger"></i>
                </span>
            </i>
            <i id="modal_indicator" class="navbar-text modal_indicator" title="Edit Mode"></i>
            <span id="notification_area"><div id="notification_kernel" class="notification_widget btn btn-xs navbar-btn undefined info" style="display: none;"><span></span></div><div id="notification_notebook" class="notification_widget btn btn-xs navbar-btn" style="display: none;"><span></span></div></span>
            <div class="navbar-collapse collapse">
              <ul class="nav navbar-nav">
                <li class="dropdown"><a href="http://localhost:8888/notebooks/lstm.ipynb#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">File</a>
                    <ul id="file_menu" class="dropdown-menu">
                        <li id="new_notebook" class="dropdown-submenu">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">New Notebook</a>
                            <ul class="dropdown-menu" id="menu-new-notebook-submenu"><li id="new-notebook-submenu-python2"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Python 2</a></li></ul>
                        </li>
                        <li id="open_notebook" title="Opens a new window with the Dashboard view">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Open...</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="copy_notebook" title="Open a copy of this notebook&#39;s contents and start a new kernel">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Make a Copy...</a></li>
                        <li id="rename_notebook"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Rename...</a></li>
                        <li id="save_checkpoint"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Save and Checkpoint</a></li>
                        <!-- <hr/> -->
                        <li class="divider"></li>
                        <li id="restore_checkpoint" class="dropdown-submenu"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Revert to Checkpoint</a>
                          <ul class="dropdown-menu"><li><a href="http://localhost:8888/notebooks/lstm.ipynb#">Saturday, November 24, 2018 4:26 PM</a></li></ul>
                        </li>
                        <li class="divider"></li>
                        <li id="print_preview"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Print Preview</a></li>
                        <li class="dropdown-submenu"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Download as</a>
                            <ul class="dropdown-menu">
                                <li id="download_ipynb"><a href="http://localhost:8888/notebooks/lstm.ipynb#">IPython Notebook (.ipynb)</a></li>
                                <li id="download_script"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Python (.py)</a></li>
                                <li id="download_html"><a href="http://localhost:8888/notebooks/lstm.ipynb#">HTML (.html)</a></li>
                                <li id="download_markdown"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Markdown (.md)</a></li>
                                <li id="download_rst"><a href="http://localhost:8888/notebooks/lstm.ipynb#">reST (.rst)</a></li>
                                <li id="download_pdf"><a href="http://localhost:8888/notebooks/lstm.ipynb#">PDF via LaTeX (.pdf)</a></li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        <li id="trust_notebook" title="Trust the output of this notebook" class="disabled">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Trusted Notebook</a></li>
                        <li class="divider"></li>
                        <li id="kill_and_exit" title="Shutdown this notebook&#39;s kernel, and close this window">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Close and Halt</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://localhost:8888/notebooks/lstm.ipynb#" class="dropdown-toggle" data-toggle="dropdown">Edit</a>
                    <ul id="edit_menu" class="dropdown-menu">
                        <li id="cut_cell"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Cut Cell</a></li>
                        <li id="copy_cell"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Copy Cell</a></li>
                        <li id="paste_cell_above" class=""><a href="http://localhost:8888/notebooks/lstm.ipynb#">Paste Cell Above</a></li>
                        <li id="paste_cell_below" class=""><a href="http://localhost:8888/notebooks/lstm.ipynb#">Paste Cell Below</a></li>
                        <li id="paste_cell_replace" class=""><a href="http://localhost:8888/notebooks/lstm.ipynb#">Paste Cell &amp; Replace</a></li>
                        <li id="delete_cell"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Delete Cell</a></li>
                        <li id="undelete_cell" class=""><a href="http://localhost:8888/notebooks/lstm.ipynb#">Undo Delete Cell</a></li>
                        <li class="divider"></li>
                        <li id="split_cell"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Split Cell</a></li>
                        <li id="merge_cell_above"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Merge Cell Above</a></li>
                        <li id="merge_cell_below"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Merge Cell Below</a></li>
                        <li class="divider"></li>
                        <li id="move_cell_up"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Move Cell Up</a></li>
                        <li id="move_cell_down"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Move Cell Down</a></li>
                        <li class="divider"></li>
                        <li id="edit_nb_metadata"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Edit Notebook Metadata</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://localhost:8888/notebooks/lstm.ipynb#" class="dropdown-toggle" data-toggle="dropdown">View</a>
                    <ul id="view_menu" class="dropdown-menu">
                        <li id="toggle_header" title="Show/Hide the IPython Notebook logo and notebook title (above menu bar)">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Toggle Header</a></li>
                        <li id="toggle_toolbar" title="Show/Hide the action icons (below menu bar)">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Toggle Toolbar</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://localhost:8888/notebooks/lstm.ipynb#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Insert</a>
                    <ul id="insert_menu" class="dropdown-menu">
                        <li id="insert_cell_above" title="Insert an empty Code cell above the currently active cell">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Insert Cell Above</a></li>
                        <li id="insert_cell_below" title="Insert an empty Code cell below the currently active cell">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Insert Cell Below</a></li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://localhost:8888/notebooks/lstm.ipynb#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Cell</a>
                    <ul id="cell_menu" class="dropdown-menu">
                        <li id="run_cell" title="Run this cell, and move cursor to the next one">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Run</a></li>
                        <li id="run_cell_select_below" title="Run this cell, select below">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Run and Select Below</a></li>
                        <li id="run_cell_insert_below" title="Run this cell, insert below">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Run and Insert Below</a></li>
                        <li id="run_all_cells" title="Run all cells in the notebook">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Run All</a></li>
                        <li id="run_all_cells_above" title="Run all cells above (but not including) this cell">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Run All Above</a></li>
                        <li id="run_all_cells_below" title="Run this cell and all cells below it">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Run All Below</a></li>
                        <li class="divider"></li>
                        <li id="change_cell_type" class="dropdown-submenu" title="All cells in the notebook have a cell type. By default, new cells are created as &#39;Code&#39; cells">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Cell Type</a>
                            <ul class="dropdown-menu">
                              <li id="to_code" title="Contents will be sent to the kernel for execution, and output will display in the footer of cell">
                                  <a href="http://localhost:8888/notebooks/lstm.ipynb#">Code</a></li>
                              <li id="to_markdown" title="Contents will be rendered as HTML and serve as explanatory text">
                                  <a href="http://localhost:8888/notebooks/lstm.ipynb#">Markdown</a></li>
                              <li id="to_raw" title="Contents will pass through nbconvert unmodified">
                                  <a href="http://localhost:8888/notebooks/lstm.ipynb#">Raw NBConvert</a></li>
                            </ul>
                        </li>
                        <li class="divider"></li>
                        <li id="current_outputs" class="dropdown-submenu"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Current Output</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_current_output" title="Hide/Show the output of the current cell">
                                    <a href="http://localhost:8888/notebooks/lstm.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_current_output_scroll" title="Scroll the output of the current cell">
                                    <a href="http://localhost:8888/notebooks/lstm.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_current_output" title="Clear the output of the current cell">
                                    <a href="http://localhost:8888/notebooks/lstm.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                        <li id="all_outputs" class="dropdown-submenu"><a href="http://localhost:8888/notebooks/lstm.ipynb#">All Output</a>
                            <ul class="dropdown-menu">
                                <li id="toggle_all_output" title="Hide/Show the output of all cells">
                                    <a href="http://localhost:8888/notebooks/lstm.ipynb#">Toggle</a>
                                </li>
                                <li id="toggle_all_output_scroll" title="Scroll the output of all cells">
                                    <a href="http://localhost:8888/notebooks/lstm.ipynb#">Toggle Scrolling</a>
                                </li>
                                <li id="clear_all_output" title="Clear the output of all cells">
                                    <a href="http://localhost:8888/notebooks/lstm.ipynb#">Clear</a>
                                </li>
                            </ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://localhost:8888/notebooks/lstm.ipynb#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Kernel</a>
                    <ul id="kernel_menu" class="dropdown-menu">
                        <li id="int_kernel" title="Send KeyboardInterrupt (CTRL-C) to the Kernel">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Interrupt</a>
                        </li>
                        <li id="restart_kernel" title="Restart the Kernel">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Restart</a>
                        </li>
                        <li id="reconnect_kernel" title="Reconnect to the Kernel">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Reconnect</a>
                        </li>
                        <li class="divider"></li>
                        <li id="menu-change-kernel" class="dropdown-submenu">
                            <a href="http://localhost:8888/notebooks/lstm.ipynb#">Change kernel</a>
                            <ul class="dropdown-menu" id="menu-change-kernel-submenu"><li id="kernel-submenu-python2"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Python 2</a></li></ul>
                        </li>
                    </ul>
                </li>
                <li class="dropdown"><a href="http://localhost:8888/notebooks/lstm.ipynb#" class="dropdown-toggle" data-toggle="dropdown" aria-expanded="false">Help</a>
                    <ul id="help_menu" class="dropdown-menu">
                        <li id="notebook_tour" title="A quick tour of the notebook user interface"><a href="http://localhost:8888/notebooks/lstm.ipynb#">User Interface Tour</a></li>
                        <li id="keyboard_shortcuts" title="Opens a tooltip with all keyboard shortcuts"><a href="http://localhost:8888/notebooks/lstm.ipynb#">Keyboard Shortcuts</a></li>
                        <li class="divider"></li>
                        

                        
                            
                                <li><a href="http://nbviewer.ipython.org/github/ipython/ipython/blob/3.x/examples/Notebook/Index.ipynb" target="&quot;_blank&quot;" title="&quot;Opens" in="" a="" new="" window&#34;="">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Notebook Help
                                </a></li>
                            
                                <li><a href="https://help.github.com/articles/markdown-basics/" target="&quot;_blank&quot;" title="&quot;Opens" in="" a="" new="" window&#34;="">
                                
                                    <i class="fa fa-external-link menu-icon pull-right"></i>
                                

                                Markdown
                                </a></li>
                            
                            
                        
                        <li id="kernel-help-links" class="divider"></li><li><a target="_blank" title="Opens in a new window" href="http://docs.python.org/2.7"><i class="fa fa-external-link menu-icon pull-right"></i><span>Python</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://ipython.org/documentation.html"><i class="fa fa-external-link menu-icon pull-right"></i><span>IPython</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.scipy.org/doc/numpy/reference/"><i class="fa fa-external-link menu-icon pull-right"></i><span>NumPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.scipy.org/doc/scipy/reference/"><i class="fa fa-external-link menu-icon pull-right"></i><span>SciPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://matplotlib.org/contents.html"><i class="fa fa-external-link menu-icon pull-right"></i><span>Matplotlib</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://docs.sympy.org/latest/index.html"><i class="fa fa-external-link menu-icon pull-right"></i><span>SymPy</span></a></li><li><a target="_blank" title="Opens in a new window" href="http://pandas.pydata.org/pandas-docs/stable/"><i class="fa fa-external-link menu-icon pull-right"></i><span>pandas</span></a></li><li class="divider"></li>
                        <li title="About IPython Notebook"><a id="notebook_about" href="http://localhost:8888/notebooks/lstm.ipynb#">About</a></li>
                    </ul>
                </li>
              </ul>
            </div>
        </div>
    </div>
</div>

<div id="maintoolbar" class="navbar">
  <div class="toolbar-inner navbar-inner navbar-nobg">
    <div id="maintoolbar-container" class="container toolbar"><div class="btn-group" id="save-notbook"><button class="btn btn-default" title="Save and Checkpoint" data-jupyter-action="ipython.save-notebook"><i class="fa-save fa"></i></button></div><div class="btn-group" id="insert_above_below"><button class="btn btn-default" title="insert cell below" data-jupyter-action="ipython.insert-cell-after"><i class="fa-plus fa"></i></button></div><div class="btn-group" id="cut_copy_paste"><button class="btn btn-default" title="cut selected cell" data-jupyter-action="ipython.cut-selected-cell"><i class="fa-cut fa"></i></button><button class="btn btn-default" title="copy selected cell" data-jupyter-action="ipython.copy-selected-cell"><i class="fa-copy fa"></i></button><button class="btn btn-default" title="paste cell below" data-jupyter-action="ipython.paste-cell-after"><i class="fa-paste fa"></i></button></div><div class="btn-group" id="move_up_down"><button class="btn btn-default" title="move selected cell up" data-jupyter-action="ipython.move-selected-cell-up"><i class="fa-arrow-up fa"></i></button><button class="btn btn-default" title="move selected cell down" data-jupyter-action="ipython.move-selected-cell-down"><i class="fa-arrow-down fa"></i></button></div><div class="btn-group" id="run_int"><button class="btn btn-default" title="run cell, select below" data-jupyter-action="ipython.run-select-next"><i class="fa-step-forward fa"></i></button><button class="btn btn-default" title="interrupt kernel" data-jupyter-action="ipython.interrupt-kernel"><i class="fa-stop fa"></i></button><button class="btn btn-default" title="restart kernel" data-jupyter-action="ipython.restart-kernel"><i class="fa-repeat fa"></i></button></div><select id="cell_type" class="form-control select-xs"><option value="code">Code</option><option value="markdown">Markdown</option><option value="raw">Raw NBConvert</option><option value="heading">Heading</option></select><div class="btn-group"><span class="navbar-text">Cell Toolbar:</span><select id="ctb_select" class="form-control select-xs"><option value="">None</option><option value="Edit Metadata">Edit Metadata</option><option value="Raw Cell Format">Raw Cell Format</option><option value="Slideshow">Slideshow</option></select></div></div>
  </div>
</div>
</div>

<div class="lower-header-bar"></div>

</div>

<div id="site" style="height: 544px; display: block;">


<div id="ipython-main-app">
    <div id="notebook_panel">
        <div id="notebook" tabindex="-1"><div class="container" id="notebook-container"><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.0938px; left: 173.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style=""><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 62px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 168px; top: 33.5px; height: 17.5px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">This analysis is <span class="cm-strong">**heavily**</span> adapted from <span class="cm-link">[this tutorial]</span><span class="cm-string cm-url">(https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/)</span> on how to apply LSTMs in Python and <span class="cm-link">[this blog post]</span><span class="cm-string cm-url">(http://colah.github.io/posts/2015-08-Understanding-LSTMs/)</span> describing how RNNs and LSTMs work.</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 62px;"></div><div class="CodeMirror-gutters" style="display: none; height: 92px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>This analysis is <strong>heavily</strong> adapted from <a href="https://machinelearningmastery.com/multivariate-time-series-forecasting-lstms-keras/" target="_blank">this tutorial</a> on how to apply LSTMs in Python and <a href="http://colah.github.io/posts/2015-08-Understanding-LSTMs/" target="_blank">this blog post</a> describing how RNNs and LSTMs work.</p>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 90.5938px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style=""><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 130px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 0px; top: 85px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Now we will a type of recurrent neural networks (RNNs) known as long short term memory (LSTM) to predict electricity demand from weather features. Whereas traditional NNs have no baseline sense of temporality, RNNs include loops, allowing information to persist across multiple timesteps. <span class="cm-strong">**Figure 1**</span> shows an unraveled RNN and demonstrates how information persists through time; by supplying the output of a previous timestep to the input of the current timestep, past information is used to predict the future.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag">!["An unrolled RNN"]</span><span class="cm-string cm-url">(RNN-unrolled.png "Unrolled RNN")</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 130px;"></div><div class="CodeMirror-gutters" style="display: none; height: 160px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Now we will a type of recurrent neural networks (RNNs) known as long short term memory (LSTM) to predict electricity demand from weather features. Whereas traditional NNs have no baseline sense of temporality, RNNs include loops, allowing information to persist across multiple timesteps. <strong>Figure 1</strong> shows an unraveled RNN and demonstrates how information persists through time; by supplying the output of a previous timestep to the input of the current timestep, past information is used to predict the future.</p>
<p><img src="./lstm_files/RNN-unrolled.png" alt="&quot;An unrolled RNN&quot;" title="Unrolled RNN"></p>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 251.328px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style=""><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 30px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 245.734px; top: 0px; height: 19px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Figure 1: Unraveled RNN</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 30px;"></div><div class="CodeMirror-gutters" style="display: none; height: 60px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Figure-1:-Unraveled-RNN">Figure 1: Unraveled RNN<a class="anchor-link" href="http://localhost:8888/notebooks/lstm.ipynb#Figure-1:-Unraveled-RNN">¶</a></h3>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 56.0938px; left: 627.281px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style=""><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 96px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 621.688px; top: 50.5px; height: 17.5px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">One issue with RNNs are long-term dependencies: it's difficult for RNNs to recall pertinent information from timesteps far away from the current timestep. Resultingly, LSTM networks were desdigned by <span class="cm-link">[Hochreiter &amp; Schmidhuber (1997)]</span><span class="cm-string cm-url">(http://www.bioinf.jku.at/publications/older/2604.pdf)</span> to allow for long-term dependencies. <span class="cm-strong">**Figure 2**</span> shows the internal structure of an LSTM, each part of which will be discussed below.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-tag">!["LSTM"]</span><span class="cm-string cm-url">(LSTM-chain.png "LSTM diagram")</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 96px;"></div><div class="CodeMirror-gutters" style="display: none; height: 126px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>One issue with RNNs are long-term dependencies: it's difficult for RNNs to recall pertinent information from timesteps far away from the current timestep. Resultingly, LSTM networks were desdigned by <a href="http://www.bioinf.jku.at/publications/older/2604.pdf" target="_blank">Hochreiter &amp; Schmidhuber (1997)</a> to allow for long-term dependencies. <strong>Figure 2</strong> shows the internal structure of an LSTM, each part of which will be discussed below.
<img src="./lstm_files/LSTM-chain.png" alt="&quot;LSTM&quot;" title="LSTM diagram"></p>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 25.0938px; left: 438.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style=""><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 49px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 433px; top: 19.5px; height: 18.5px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-3">### Figure 2: LSTM diagram. The pink icons represent matrix transformations (addition, multiplication, tanh) while the yellow icons represent different network layers</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 49px;"></div><div class="CodeMirror-gutters" style="display: none; height: 79px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h3 id="Figure-2:-LSTM-diagram.-The-pink-icons-represent-matrix-transformations-(addition,-multiplication,-tanh)-while-the-yellow-icons-represent-different-network-layers">Figure 2: LSTM diagram. The pink icons represent matrix transformations (addition, multiplication, tanh) while the yellow icons represent different network layers<a class="anchor-link" href="http://localhost:8888/notebooks/lstm.ipynb#Figure-2:-LSTM-diagram.-The-pink-icons-represent-matrix-transformations-(addition,-multiplication,-tanh)-while-the-yellow-icons-represent-different-network-layers">¶</a></h3>
</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 277.094px; left: 761.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style=""><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1" draggable="false"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 300px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 756px; top: 271.5px; height: 17.5px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The main idea behind LSTMs is the cell state: the horizontal line running across the top of the LSTM cell. Crucially, the LSTM has the ability to add or remove information from the cell state through structures called gates.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Data flows through the layers of an LSTM in a sequence of steps:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">1. First the forget gate layer, which looks at the previous LSTMs output and the current input and decides how much information should be removed from the cell state between timesteps.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">2. Second the input gate layer, which decides which values to update and importantly <span class="cm-em">*how much*</span> to update each value in the cell state.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">3. Third the tanh layer, which creates a vector of candidate information to be possibly added to the cell state.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">4. Fourth we combine the previous steps by first removing the information we decided to forget in step one and then adding the candidate values decided in step three scaled by how much we decided to update each state value in step two. The product here is the new cell state, which will be transfered to the subsequent LSTM.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">5. Finally we decide what to output (<span class="cm-delimit">$</span>h_t<span class="cm-delimit">$</span> in the diagram). The output will be based on our cell state, but filtered according to which information we decided to add and remove before.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">This is a rudimentary overview of RNNs and LSTMs. For a more in-depth, mathematical review, check out the blog post linked at the top. Now we apply LSTMs to predict electricity demand from weather features.</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 300px;"></div><div class="CodeMirror-gutters" style="display: none; height: 330px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>The main idea behind LSTMs is the cell state: the horizontal line running across the top of the LSTM cell. Crucially, the LSTM has the ability to add or remove information from the cell state through structures called gates.</p>
<p>Data flows through the layers of an LSTM in a sequence of steps:</p>
<ol>
<li>First the forget gate layer, which looks at the previous LSTMs output and the current input and decides how much information should be removed from the cell state between timesteps.</li>
<li>Second the input gate layer, which decides which values to update and importantly <em>how much</em> to update each value in the cell state.</li>
<li>Third the tanh layer, which creates a vector of candidate information to be possibly added to the cell state.</li>
<li>Fourth we combine the previous steps by first removing the information we decided to forget in step one and then adding the candidate values decided in step three scaled by how much we decided to update each state value in step two. The product here is the new cell state, which will be transfered to the subsequent LSTM.</li>
<li>Finally we decide what to output (<span class="MathJax_Preview" style="color: inherit;"></span><span class="MathJax" id="MathJax-Element-9-Frame" style=""><nobr><span class="math" id="MathJax-Span-41" role="math" style="width: 0.955em; display: inline-block;"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px; font-size: 120%;"><span style="position: absolute; clip: rect(1.372em, 1000em, 2.562em, -999.997em); top: -2.199em; left: 0.003em;"><span class="mrow" id="MathJax-Span-42"><span class="msubsup" id="MathJax-Span-43"><span style="display: inline-block; position: relative; width: 0.777em; height: 0px;"><span style="position: absolute; clip: rect(3.158em, 1000em, 4.17em, -999.997em); top: -3.985em; left: 0.003em;"><span class="mi" id="MathJax-Span-44" style="font-family: STIXMathJax_Main-italic;">h</span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span><span style="position: absolute; top: -3.807em; left: 0.479em;"><span class="mi" id="MathJax-Span-45" style="font-size: 70.7%; font-family: STIXMathJax_Main-italic;">t<span style="display: inline-block; overflow: hidden; height: 1px; width: 0.003em;"></span></span><span style="display: inline-block; width: 0px; height: 3.991em;"></span></span></span></span></span><span style="display: inline-block; width: 0px; height: 2.205em;"></span></span></span><span style="border-left: 0.004em solid; display: inline-block; overflow: hidden; width: 0px; height: 1.146em; vertical-align: -0.282em;"></span></span></nobr></span><script type="math/tex" id="MathJax-Element-9">h_t</script> in the diagram). The output will be based on our cell state, but filtered according to which information we decided to add and remove before.</li>
</ol>
<p>This is a rudimentary overview of RNNs and LSTMs. For a more in-depth, mathematical review, check out the blog post linked at the top. Now we apply LSTMs to predict electricity demand from weather features.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[8]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.5938px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style=""><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 215px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 0px; top: 17px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-operator">%</span><span class="cm-variable">matplotlib</span> <span class="cm-variable">inline</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">pandas</span> <span class="cm-keyword">as</span> <span class="cm-variable">pd</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">numpy</span> <span class="cm-keyword">as</span> <span class="cm-variable">np</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">import</span> <span class="cm-variable">matplotlib</span>.<span class="cm-variable">pyplot</span> <span class="cm-keyword">as</span> <span class="cm-variable">plt</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-variable">preprocessing</span> <span class="cm-keyword">import</span> <span class="cm-variable">LabelEncoder</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-variable">preprocessing</span> <span class="cm-keyword">import</span> <span class="cm-variable">MinMaxScaler</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">sklearn</span>.<span class="cm-variable">metrics</span> <span class="cm-keyword">import</span> <span class="cm-variable">mean_squared_error</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-variable">models</span> <span class="cm-keyword">import</span> <span class="cm-variable">Sequential</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">from</span> <span class="cm-variable">keras</span>.<span class="cm-variable">layers</span> <span class="cm-keyword">import</span> <span class="cm-variable">Dense</span>, <span class="cm-variable">LSTM</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 215px;"></div><div class="CodeMirror-gutters" style="display: none; height: 245px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[3]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 532.594px; left: 39.5938px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style=""><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 555px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 34px; top: 527px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">def</span> <span class="cm-def">series_to_supervised</span>(<span class="cm-variable">data</span>, <span class="cm-variable">col_names</span>, <span class="cm-variable">n_in</span>=<span class="cm-number">1</span>, <span class="cm-variable">n_out</span>=<span class="cm-number">1</span>, <span class="cm-variable">dropnan</span>=<span class="cm-builtin">True</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-string">"""</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string"> &nbsp;  Frame a time series as a supervised learning dataset.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string"> &nbsp;  Arguments:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string"> &nbsp; &nbsp; &nbsp;  data: Sequence of observations as a list or NumPy array.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string"> &nbsp; &nbsp; &nbsp;  n_in: Number of lag observations as input (X).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string"> &nbsp; &nbsp; &nbsp;  n_out: Number of observations as output (y).</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string"> &nbsp; &nbsp; &nbsp;  dropnan: Boolean whether or not to drop rows with NaN values.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string"> &nbsp;  Returns:</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string"> &nbsp; &nbsp; &nbsp;  Pandas DataFrame of series framed for supervised learning.</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-string"> &nbsp;  """</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">n_vars</span> = <span class="cm-number">1</span> <span class="cm-keyword">if</span> <span class="cm-builtin">type</span>(<span class="cm-variable">data</span>) <span class="cm-keyword">is</span> <span class="cm-builtin">list</span> <span class="cm-keyword">else</span> <span class="cm-variable">data</span>.<span class="cm-variable">shape</span>[<span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">df</span> = <span class="cm-variable">pd</span>.<span class="cm-variable">DataFrame</span>(<span class="cm-variable">data</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">cols</span>, <span class="cm-variable">names</span> = <span class="cm-builtin">list</span>(), <span class="cm-builtin">list</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment"># input sequence (t-n, ... t-1)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">n_in</span>, <span class="cm-number">0</span>, <span class="cm-operator">-</span><span class="cm-number">1</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">cols</span>.<span class="cm-variable">append</span>(<span class="cm-variable">df</span>.<span class="cm-variable">shift</span>(<span class="cm-variable">i</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">names</span> += [(<span class="cm-string">'%s(t-%d)'</span> <span class="cm-operator">%</span> (<span class="cm-variable">col_names</span>[<span class="cm-variable">j</span>], <span class="cm-variable">i</span>)) <span class="cm-keyword">for</span> <span class="cm-variable">j</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">n_vars</span>)]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment"># forecast sequence (t, t+1, ... t+n)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">for</span> <span class="cm-variable">i</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-number">0</span>, <span class="cm-variable">n_out</span>):</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">cols</span>.<span class="cm-variable">append</span>(<span class="cm-variable">df</span>.<span class="cm-variable">shift</span>(<span class="cm-operator">-</span><span class="cm-variable">i</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-keyword">if</span> <span class="cm-variable">i</span> <span class="cm-operator">==</span> <span class="cm-number">0</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">names</span> += [(<span class="cm-string">'%s(t)'</span> <span class="cm-operator">%</span> (<span class="cm-variable">col_names</span>[<span class="cm-variable">j</span>])) <span class="cm-keyword">for</span> <span class="cm-variable">j</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">n_vars</span>)]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-keyword">else</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;  <span class="cm-variable">names</span> += [(<span class="cm-string">'%s(t+%d)'</span> <span class="cm-operator">%</span> (<span class="cm-variable">col_names</span>[<span class="cm-variable">j</span>], <span class="cm-variable">i</span>)) <span class="cm-keyword">for</span> <span class="cm-variable">j</span> <span class="cm-keyword">in</span> <span class="cm-builtin">range</span>(<span class="cm-variable">n_vars</span>)]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment"># put it all together</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">agg</span> = <span class="cm-variable">pd</span>.<span class="cm-variable">concat</span>(<span class="cm-variable">cols</span>, <span class="cm-variable">axis</span>=<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-variable">agg</span>.<span class="cm-variable">columns</span> = <span class="cm-variable">names</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-comment"># drop rows with NaN values</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">if</span> <span class="cm-variable">dropnan</span>:</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp; &nbsp; &nbsp;  <span class="cm-variable">agg</span>.<span class="cm-variable">dropna</span>(<span class="cm-variable">inplace</span>=<span class="cm-builtin">True</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"> &nbsp;  <span class="cm-keyword">return</span> <span class="cm-variable">agg</span></span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 555px;"></div><div class="CodeMirror-gutters" style="display: none; height: 585px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[2]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 226.594px; left: 198.766px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style=""><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 249px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 193.172px; top: 221px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">WORKING_DIR</span> = <span class="cm-string">'/Users/rvg/Documents/springboard_ds/springboard_portfolio/Electricity_Demand/'</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">la_df</span> = <span class="cm-variable">pd</span>.<span class="cm-variable">read_pickle</span>(<span class="cm-variable">WORKING_DIR</span> <span class="cm-operator">+</span> <span class="cm-string">'data/LA_df.pkl'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">seattle_df</span> = <span class="cm-variable">pd</span>.<span class="cm-variable">read_pickle</span>(<span class="cm-variable">WORKING_DIR</span> <span class="cm-operator">+</span> <span class="cm-string">'data/seattle_df.pkl'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment">#the following example will be with the LA dataset only</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">dataset</span> = <span class="cm-variable">la_df</span>.<span class="cm-variable">copy</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># set the column we want to predict (demand) to the first columns for consistency with the tutorial</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">cols</span> = <span class="cm-builtin">list</span>(<span class="cm-variable">dataset</span>.<span class="cm-variable">columns</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">cols</span>.<span class="cm-variable">remove</span>(<span class="cm-string">'demand'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">cols</span>.<span class="cm-variable">insert</span>(<span class="cm-number">0</span>,<span class="cm-string">'demand'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">dataset</span> = <span class="cm-variable">dataset</span>[<span class="cm-variable">cols</span>]</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 249px;"></div><div class="CodeMirror-gutters" style="display: none; height: 279px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style="display: none;"></div><div class="output" style="display: none;"></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 5.59375px; left: 293.125px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style=""><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 150px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 287.531px; top: 0px; height: 20px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Preparing data for LSTM</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The first step is to prepare the dataset for the LSTM.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">This involves framing the dataset as a supervised learning problem and normalizing the input variables.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">We will frame the supervised learning problem as predicting the electricity demand at the current hour (t) given the electricity demand and weather conditions at the prior time step.</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 150px;"></div><div class="CodeMirror-gutters" style="display: none; height: 180px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Preparing-data-for-LSTM">Preparing data for LSTM<a class="anchor-link" href="http://localhost:8888/notebooks/lstm.ipynb#Preparing-data-for-LSTM">¶</a></h2>
<p>The first step is to prepare the dataset for the LSTM.</p>
<p>This involves framing the dataset as a supervised learning problem and normalizing the input variables.</p>
<p>We will frame the supervised learning problem as predicting the electricity demand at the current hour (t) given the electricity demand and weather conditions at the prior time step.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[6]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 175.594px; left: 190.375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style=""><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 198px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 184.781px; top: 170px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">values</span> = <span class="cm-variable">dataset</span>.<span class="cm-variable">values</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># ensure all data is float</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">values</span> = <span class="cm-variable">values</span>.<span class="cm-variable">astype</span>(<span class="cm-string">'float32'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># normalize features</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">scaler</span> = <span class="cm-variable">MinMaxScaler</span>(<span class="cm-variable">feature_range</span>=(<span class="cm-number">0</span>, <span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">scaled</span> = <span class="cm-variable">scaler</span>.<span class="cm-variable">fit_transform</span>(<span class="cm-variable">values</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># frame as supervised learning</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">reframed</span> = <span class="cm-variable">series_to_supervised</span>(<span class="cm-variable">scaled</span>, <span class="cm-variable">dataset</span>.<span class="cm-variable">columns</span>, <span class="cm-number">1</span>, <span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># drop columns we don't want to predict</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">reframed</span>.<span class="cm-variable">drop</span>(<span class="cm-variable">reframed</span>.<span class="cm-variable">columns</span>[[<span class="cm-number">18</span>,<span class="cm-number">19</span>,<span class="cm-number">20</span>,<span class="cm-number">21</span>,<span class="cm-number">22</span>,<span class="cm-number">23</span>,<span class="cm-number">24</span>,<span class="cm-number">25</span>,<span class="cm-number">26</span>,<span class="cm-number">27</span>,<span class="cm-number">28</span>,<span class="cm-number">29</span>,<span class="cm-number">30</span>,<span class="cm-number">31</span>,<span class="cm-number">32</span>,<span class="cm-number">33</span>]], <span class="cm-variable">axis</span>=<span class="cm-number">1</span>, <span class="cm-variable">inplace</span>=<span class="cm-builtin">True</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span>(<span class="cm-variable">reframed</span>.<span class="cm-variable">head</span>())</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 198px;"></div><div class="CodeMirror-gutters" style="display: none; height: 228px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>   demand(t-1)  hourlyvisibility(t-1)  hourlydewpointtempf(t-1)  \
1     0.237244                      1                  0.915663   
2     0.186420                      1                  0.927711   
3     0.155685                      1                  0.915663   
4     0.134592                      1                  0.891566   
5     0.135195                      1                  0.891566   

   hourlyrelativehumidity(t-1)  hourlywindspeed(t-1)  \
1                     0.680412                   0.0   
2                     0.628866                   0.0   
3                     0.515464                   0.0   
4                     0.443299                   0.2   
5                     0.494845                   0.2   

   hourlystationpressure(t-1)  hourlyprecip(t-1)  dailyheatingdegreedays(t-1)  \
1                    0.466019                  0                            0   
2                    0.466019                  0                            0   
3                    0.456310                  0                            0   
4                    0.417475                  0                            0   
5                    0.417475                  0                            0   

   dailycoolingdegreedays(t-1)  hourlycoolingdegrees(t-1)  \
1                     0.416667                   0.181818   
2                     0.416667                   0.363636   
3                     0.416667                   0.454545   
4                     0.416667                   0.363636   
5                     0.416667                   0.272727   

   hourlyheatingdegrees(t-1)  hourlytimeofday(t-1)  \
1                          0                     0   
2                          0                     0   
3                          0                     0   
4                          0                     0   
5                          0                     0   

   hourlyskyconditions_BKN(t-1)  hourlyskyconditions_CLR(t-1)  \
1                             0                             1   
2                             0                             0   
3                             0                             1   
4                             0                             1   
5                             0                             1   

   hourlyskyconditions_FEW(t-1)  hourlyskyconditions_OVC(t-1)  \
1                             0                             0   
2                             1                             0   
3                             0                             0   
4                             0                             0   
5                             0                             0   

   hourlyskyconditions_SCT(t-1)  demand(t)  
1                             0   0.186420  
2                             0   0.155685  
3                             0   0.134592  
4                             0   0.135195  
5                             0   0.157091  
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 127.594px; left: 72.5938px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style=""><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 167px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre>x</pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 67px; top: 122px; height: 16.5px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Define and Fit Model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">In this section, we will fit an LSTM on the multivariate input data.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">First, we must split the prepared dataset into train and test sets. To speed up the training of the model for this demonstration, we will only fit the model on the first year of data, then evaluate it on the remaining data.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">We split the dataset into train and test sets, then splits the train and test sets into input and output variables. Finally, the inputs (X) are reshaped into the 3D format expected by LSTMs, namely [samples, timesteps, features].</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 167px;"></div><div class="CodeMirror-gutters" style="display: none; height: 197px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Define-and-Fit-Model">Define and Fit Model<a class="anchor-link" href="http://localhost:8888/notebooks/lstm.ipynb#Define-and-Fit-Model">¶</a></h2>
<p>In this section, we will fit an LSTM on the multivariate input data.</p>
<p>First, we must split the prepared dataset into train and test sets. To speed up the training of the model for this demonstration, we will only fit the model on the first year of data, then evaluate it on the remaining data.</p>
<p>We split the dataset into train and test sets, then splits the train and test sets into input and output variables. Finally, the inputs (X) are reshaped into the 3D format expected by LSTMs, namely [samples, timesteps, features].</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[7]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 175.594px; left: 534.734px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style=""><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 198px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style="visibility: hidden;"><div class="CodeMirror-cursor" style="left: 529.141px; top: 170px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">values</span> = <span class="cm-variable">reframed</span>.<span class="cm-variable">values</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">n_train_hours</span> = <span class="cm-number">365</span> <span class="cm-operator">*</span> <span class="cm-number">24</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">train</span> = <span class="cm-variable">values</span>[:<span class="cm-variable">n_train_hours</span>, :]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">test</span> = <span class="cm-variable">values</span>[<span class="cm-variable">n_train_hours</span>:, :]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># split into input and outputs</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">train_X</span>, <span class="cm-variable">train_y</span> = <span class="cm-variable">train</span>[:, :<span class="cm-operator">-</span><span class="cm-number">1</span>], <span class="cm-variable">train</span>[:, <span class="cm-operator">-</span><span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">test_X</span>, <span class="cm-variable">test_y</span> = <span class="cm-variable">test</span>[:, :<span class="cm-operator">-</span><span class="cm-number">1</span>], <span class="cm-variable">test</span>[:, <span class="cm-operator">-</span><span class="cm-number">1</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># reshape input to be 3D [samples, timesteps, features]</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">train_X</span> = <span class="cm-variable">train_X</span>.<span class="cm-variable">reshape</span>((<span class="cm-variable">train_X</span>.<span class="cm-variable">shape</span>[<span class="cm-number">0</span>], <span class="cm-number">1</span>, <span class="cm-variable">train_X</span>.<span class="cm-variable">shape</span>[<span class="cm-number">1</span>]))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">test_X</span> = <span class="cm-variable">test_X</span>.<span class="cm-variable">reshape</span>((<span class="cm-variable">test_X</span>.<span class="cm-variable">shape</span>[<span class="cm-number">0</span>], <span class="cm-number">1</span>, <span class="cm-variable">test_X</span>.<span class="cm-variable">shape</span>[<span class="cm-number">1</span>]))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span>(<span class="cm-variable">train_X</span>.<span class="cm-variable">shape</span>, <span class="cm-variable">train_y</span>.<span class="cm-variable">shape</span>, <span class="cm-variable">test_X</span>.<span class="cm-variable">shape</span>, <span class="cm-variable">test_y</span>.<span class="cm-variable">shape</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 198px;"></div><div class="CodeMirror-gutters" style="display: none; height: 228px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>((8760, 1, 17), (8760,), (18294, 1, 17), (18294,))
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 158.094px; left: 232.422px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style=""><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 232px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 226.828px; top: 152.5px; height: 17.5px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Now we can define and fit our LSTM model.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">We will define the LSTM with 50 neurons in the first hidden layer and 1 neuron in the output layer for predicting electricity demand. The input shape will be 1 time step with 17 features.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">We will use the Mean Absolute Error (MAE) loss function and the efficient Adam version of stochastic gradient descent.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The model will be fit for 50 training epochs with a batch size of 72. Epochs Remember that the internal state of the LSTM in Keras is reset at the end of each batch, so an internal state that is a function of a number of days may be helpful (try testing this).</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">Finally, we keep track of both the training and test loss during training by setting the validation_data argument in the fit() function. At the end of the run both the training and test loss are plotted.</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 232px;"></div><div class="CodeMirror-gutters" style="display: none; height: 262px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>Now we can define and fit our LSTM model.</p>
<p>We will define the LSTM with 50 neurons in the first hidden layer and 1 neuron in the output layer for predicting electricity demand. The input shape will be 1 time step with 17 features.</p>
<p>We will use the Mean Absolute Error (MAE) loss function and the efficient Adam version of stochastic gradient descent.</p>
<p>The model will be fit for 50 training epochs with a batch size of 72. Epochs Remember that the internal state of the LSTM in Keras is reset at the end of each batch, so an internal state that is a function of a number of days may be helpful (try testing this).</p>
<p>Finally, we keep track of both the training and test loss during training by setting the validation_data argument in the fit() function. At the end of the run both the training and test loss are plotted.</p>
</div></div></div><div class="cell code_cell rendered unselected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[9]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 141.594px; left: 123.203px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style=""><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 215px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 117.609px; top: 136px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># design network</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">model</span> = <span class="cm-variable">Sequential</span>()</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">model</span>.<span class="cm-variable">add</span>(<span class="cm-variable">LSTM</span>(<span class="cm-number">50</span>, <span class="cm-variable">input_shape</span>=(<span class="cm-variable">train_X</span>.<span class="cm-variable">shape</span>[<span class="cm-number">1</span>], <span class="cm-variable">train_X</span>.<span class="cm-variable">shape</span>[<span class="cm-number">2</span>])))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">model</span>.<span class="cm-variable">add</span>(<span class="cm-variable">Dense</span>(<span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">model</span>.<span class="cm-builtin">compile</span>(<span class="cm-variable">loss</span>=<span class="cm-string">'mae'</span>, <span class="cm-variable">optimizer</span>=<span class="cm-string">'adam'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># fit network</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">history</span> = <span class="cm-variable">model</span>.<span class="cm-variable">fit</span>(<span class="cm-variable">train_X</span>, <span class="cm-variable">train_y</span>, <span class="cm-variable">epochs</span>=<span class="cm-number">50</span>, <span class="cm-variable">batch_size</span>=<span class="cm-number">72</span>, <span class="cm-variable">validation_data</span>=(<span class="cm-variable">test_X</span>, <span class="cm-variable">test_y</span>), <span class="cm-variable">verbose</span>=<span class="cm-number">2</span>, <span class="cm-variable">shuffle</span>=<span class="cm-builtin">False</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># plot history</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-variable">plot</span>(<span class="cm-variable">history</span>.<span class="cm-variable">history</span>[<span class="cm-string">'loss'</span>], <span class="cm-variable">label</span>=<span class="cm-string">'train'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-variable">plot</span>(<span class="cm-variable">history</span>.<span class="cm-variable">history</span>[<span class="cm-string">'val_loss'</span>], <span class="cm-variable">label</span>=<span class="cm-string">'test'</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">plt</span>.<span class="cm-variable">legend</span>()</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 215px;"></div><div class="CodeMirror-gutters" style="display: none; height: 245px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Train on 8760 samples, validate on 18294 samples
Epoch 1/50
 - 1s - loss: 0.0843 - val_loss: 0.0817
Epoch 2/50
 - 0s - loss: 0.0601 - val_loss: 0.0705
Epoch 3/50
 - 0s - loss: 0.0504 - val_loss: 0.0541
Epoch 4/50
 - 0s - loss: 0.0404 - val_loss: 0.0397
Epoch 5/50
 - 1s - loss: 0.0328 - val_loss: 0.0344
Epoch 6/50
 - 1s - loss: 0.0290 - val_loss: 0.0268
Epoch 7/50
 - 1s - loss: 0.0266 - val_loss: 0.0265
Epoch 8/50
 - 0s - loss: 0.0254 - val_loss: 0.0253
Epoch 9/50
 - 0s - loss: 0.0247 - val_loss: 0.0256
Epoch 10/50
 - 0s - loss: 0.0244 - val_loss: 0.0262
Epoch 11/50
 - 0s - loss: 0.0242 - val_loss: 0.0266
Epoch 12/50
 - 0s - loss: 0.0240 - val_loss: 0.0282
Epoch 13/50
 - 0s - loss: 0.0237 - val_loss: 0.0278
Epoch 14/50
 - 0s - loss: 0.0235 - val_loss: 0.0281
Epoch 15/50
 - 1s - loss: 0.0233 - val_loss: 0.0279
Epoch 16/50
 - 1s - loss: 0.0233 - val_loss: 0.0280
Epoch 17/50
 - 1s - loss: 0.0231 - val_loss: 0.0282
Epoch 18/50
 - 1s - loss: 0.0230 - val_loss: 0.0286
Epoch 19/50
 - 0s - loss: 0.0230 - val_loss: 0.0275
Epoch 20/50
 - 1s - loss: 0.0228 - val_loss: 0.0272
Epoch 21/50
 - 1s - loss: 0.0226 - val_loss: 0.0271
Epoch 22/50
 - 1s - loss: 0.0226 - val_loss: 0.0264
Epoch 23/50
 - 1s - loss: 0.0227 - val_loss: 0.0263
Epoch 24/50
 - 1s - loss: 0.0226 - val_loss: 0.0257
Epoch 25/50
 - 0s - loss: 0.0225 - val_loss: 0.0257
Epoch 26/50
 - 0s - loss: 0.0224 - val_loss: 0.0263
Epoch 27/50
 - 0s - loss: 0.0225 - val_loss: 0.0254
Epoch 28/50
 - 1s - loss: 0.0225 - val_loss: 0.0249
Epoch 29/50
 - 1s - loss: 0.0225 - val_loss: 0.0261
Epoch 30/50
 - 1s - loss: 0.0225 - val_loss: 0.0248
Epoch 31/50
 - 1s - loss: 0.0224 - val_loss: 0.0248
Epoch 32/50
 - 1s - loss: 0.0226 - val_loss: 0.0249
Epoch 33/50
 - 0s - loss: 0.0225 - val_loss: 0.0251
Epoch 34/50
 - 0s - loss: 0.0223 - val_loss: 0.0258
Epoch 35/50
 - 0s - loss: 0.0223 - val_loss: 0.0253
Epoch 36/50
 - 1s - loss: 0.0223 - val_loss: 0.0261
Epoch 37/50
 - 1s - loss: 0.0222 - val_loss: 0.0256
Epoch 38/50
 - 1s - loss: 0.0222 - val_loss: 0.0251
Epoch 39/50
 - 1s - loss: 0.0224 - val_loss: 0.0252
Epoch 40/50
 - 1s - loss: 0.0224 - val_loss: 0.0246
Epoch 41/50
 - 1s - loss: 0.0223 - val_loss: 0.0246
Epoch 42/50
 - 1s - loss: 0.0222 - val_loss: 0.0258
Epoch 43/50
 - 1s - loss: 0.0223 - val_loss: 0.0247
Epoch 44/50
 - 1s - loss: 0.0221 - val_loss: 0.0245
Epoch 45/50
 - 1s - loss: 0.0222 - val_loss: 0.0252
Epoch 46/50
 - 1s - loss: 0.0223 - val_loss: 0.0249
Epoch 47/50
 - 1s - loss: 0.0222 - val_loss: 0.0243
Epoch 48/50
 - 0s - loss: 0.0221 - val_loss: 0.0248
Epoch 49/50
 - 1s - loss: 0.0221 - val_loss: 0.0247
Epoch 50/50
 - 0s - loss: 0.0221 - val_loss: 0.0253
</pre></div></div><div class="output_area"><div class="prompt output_prompt">Out[9]:</div><div class="output_subarea output_text output_result"><pre>&lt;matplotlib.legend.Legend at 0x126756990&gt;</pre></div></div><div class="output_area"><div class="prompt"></div><div class="output_subarea output_png"><img src="data:image/png;base64,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%0AAElFTkSuQmCC"></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 25.5938px; left: 5.59375px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style=""><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 167px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 0px; top: 20px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-header cm-header-2">## Evaluate Model</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">After the model is fit, we can forecast for the entire test dataset.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">We combine the forecast with the test dataset and invert the scaling. We also invert scaling on the test dataset with the expected pollution numbers.</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span cm-text="">​</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">With forecasts and actual values in their original scale, we can then calculate an error score for the model. In this case, we calculate the Root Mean Squared Error (RMSE) that gives error in the same units as the variable itself.</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 167px;"></div><div class="CodeMirror-gutters" style="display: none; height: 197px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><h2 id="Evaluate-Model">Evaluate Model<a class="anchor-link" href="http://localhost:8888/notebooks/lstm.ipynb#Evaluate-Model">¶</a></h2>
<p>After the model is fit, we can forecast for the entire test dataset.</p>
<p>We combine the forecast with the test dataset and invert the scaling. We also invert scaling on the test dataset with the expected pollution numbers.</p>
<p>With forecasts and actual values in their original scale, we can then calculate an error score for the model. In this case, we calculate the Root Mean Squared Error (RMSE) that gives error in the same units as the variable itself.</p>
</div></div></div><div class="cell code_cell rendered selected" tabindex="2"><div class="input"><div class="prompt input_prompt">In&nbsp;[10]:</div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-ipython CodeMirror-wrap CodeMirror-focused"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 39.5938px; left: 501.125px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style=""><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 266px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors"><div class="CodeMirror-cursor" style="left: 495.531px; top: 34px; height: 17px;">&nbsp;</div></div><div class="CodeMirror-code" style=""><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># make a prediction</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">yhat</span> = <span class="cm-variable">model</span>.<span class="cm-variable">predict</span>(<span class="cm-variable">test_X</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">test_X</span> = <span class="cm-variable">test_X</span>.<span class="cm-variable">reshape</span><span class=" CodeMirror-matchingbracket">(</span>(<span class="cm-variable">test_X</span>.<span class="cm-variable">shape</span>[<span class="cm-number">0</span>], <span class="cm-variable">test_X</span>.<span class="cm-variable">shape</span>[<span class="cm-number">2</span>])<span class=" CodeMirror-matchingbracket">)</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># invert scaling for forecast</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">inv_yhat</span> = <span class="cm-variable">np</span>.<span class="cm-variable">concatenate</span>((<span class="cm-variable">yhat</span>, <span class="cm-variable">test_X</span>[:, <span class="cm-number">1</span>:]), <span class="cm-variable">axis</span>=<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">inv_yhat</span> = <span class="cm-variable">scaler</span>.<span class="cm-variable">inverse_transform</span>(<span class="cm-variable">inv_yhat</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">inv_yhat</span> = <span class="cm-variable">inv_yhat</span>[:,<span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># invert scaling for actual</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">test_y</span> = <span class="cm-variable">test_y</span>.<span class="cm-variable">reshape</span>((<span class="cm-builtin">len</span>(<span class="cm-variable">test_y</span>), <span class="cm-number">1</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">inv_y</span> = <span class="cm-variable">np</span>.<span class="cm-variable">concatenate</span>((<span class="cm-variable">test_y</span>, <span class="cm-variable">test_X</span>[:, <span class="cm-number">1</span>:]), <span class="cm-variable">axis</span>=<span class="cm-number">1</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">inv_y</span> = <span class="cm-variable">scaler</span>.<span class="cm-variable">inverse_transform</span>(<span class="cm-variable">inv_y</span>)</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">inv_y</span> = <span class="cm-variable">inv_y</span>[:,<span class="cm-number">0</span>]</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-comment"># calculate RMSE</span></span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-variable">rmse</span> = <span class="cm-variable">np</span>.<span class="cm-variable">sqrt</span>(<span class="cm-variable">mean_squared_error</span>(<span class="cm-variable">inv_y</span>, <span class="cm-variable">inv_yhat</span>))</span></pre><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;"><span class="cm-keyword">print</span>(<span class="cm-string">'Test RMSE: %.3f'</span> <span class="cm-operator">%</span> <span class="cm-variable">rmse</span>)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 266px;"></div><div class="CodeMirror-gutters" style="display: none; height: 296px;"></div></div></div></div></div></div><div class="widget-area" style="display: none;"><div class="prompt"><button class="close">×</button></div><div class="widget-subarea"></div></div><div class="output_wrapper"><div class="out_prompt_overlay prompt" title="click to scroll output; double click to hide" style=""></div><div class="output" style=""><div class="output_area"><div class="prompt"></div><div class="output_subarea output_text output_stream output_stdout"><pre>Test RMSE: 162.823
</pre></div></div></div><div class="btn btn-default output_collapsed" title="click to expand output" style="display: none;">. . .</div></div></div><div class="cell text_cell rendered unselected" tabindex="2"><div class="prompt input_prompt"></div><div class="inner_cell"><div class="ctb_hideshow"><div class="celltoolbar"></div></div><div class="input_area"><div class="CodeMirror cm-s-default CodeMirror-wrap"><div style="overflow: hidden; position: relative; width: 3px; height: 0px; top: 22.0938px; left: 123.594px;"><textarea autocorrect="off" autocapitalize="off" spellcheck="false" tabindex="0" style="position: absolute; padding: 0px; width: 1000px; height: 1em; outline: none;"></textarea></div><div class="CodeMirror-vscrollbar" cm-not-content="true" style="min-width: 18px;"><div style="min-width: 1px; height: 0px;"></div></div><div class="CodeMirror-hscrollbar" cm-not-content="true" style=""><div style="height: 100%; min-height: 1px; width: 0px;"></div></div><div class="CodeMirror-scrollbar-filler" cm-not-content="true"></div><div class="CodeMirror-gutter-filler" cm-not-content="true"></div><div class="CodeMirror-scroll" tabindex="-1"><div class="CodeMirror-sizer" style="margin-left: 0px; margin-bottom: 0px; border-right-width: 30px; min-height: 45px; padding-right: 0px; padding-bottom: 0px;"><div style="position: relative; top: 0px;"><div class="CodeMirror-lines"><div style="position: relative; outline: none;"><div class="CodeMirror-measure"><pre><span>xxxxxxxxxx</span></pre></div><div class="CodeMirror-measure"></div><div style="position: relative; z-index: 1;"></div><div class="CodeMirror-cursors" style=""><div class="CodeMirror-cursor" style="left: 118px; top: 16.5px; height: 17.5px;">&nbsp;</div></div><div class="CodeMirror-code"><pre class=" CodeMirror-line "><span style="padding-right: 0.1px;">The RMSE on the test set is quite remarkable--it's almost half the RMSE of our best supervised learning algorithm! (Bagging, ~300)</span></pre></div></div></div></div></div><div style="position: absolute; height: 30px; width: 1px; top: 45px;"></div><div class="CodeMirror-gutters" style="display: none; height: 75px;"></div></div></div></div><div class="text_cell_render rendered_html" tabindex="-1"><p>The RMSE on the test set is quite remarkable--it's almost half the RMSE of our best supervised learning algorithm! (Bagging, ~300)</p>
</div></div></div></div><div class="end_space"></div></div>
        <div id="tooltip" class="ipython_tooltip" style="display:none"><div class="tooltipbuttons"><a href="http://localhost:8888/notebooks/lstm.ipynb#" role="button" class="ui-button"><span class="ui-icon ui-icon-close">Close</span></a><a href="http://localhost:8888/notebooks/lstm.ipynb#" class="ui-corner-all" role="button" id="expanbutton" title="Grow the tooltip vertically (press shift-tab twice)"><span class="ui-icon ui-icon-plus">Expand</span></a><a href="http://localhost:8888/notebooks/lstm.ipynb#" role="button" class="ui-button" title="show the current docstring in pager (press shift-tab 4 times)"><span class="ui-icon ui-icon-arrowstop-l-n">Open in Pager</span></a><a href="http://localhost:8888/notebooks/lstm.ipynb#" role="button" class="ui-button" title="Tooltip will linger for 10 seconds while you type" style="display: none;"><span class="ui-icon ui-icon-clock">Close</span></a></div><div class="pretooltiparrow"></div><div class="tooltiptext smalltooltip"></div></div>
    </div>
</div>



</div>



<div id="pager" class="ui-resizable">
    <div id="pager-contents">
        <div id="pager-container" class="container"></div>
    </div>
    <div id="pager-button-area"><a role="button" title="Open the pager in an external window" class="ui-button"><span class="ui-icon ui-icon-extlink"></span></a><a role="button" title="Close the pager" class="ui-button"><span class="ui-icon ui-icon-close"></span></a></div>
<div class="ui-resizable-handle ui-resizable-n" style="z-index: 90;"></div></div>






<script type="text/javascript">
    sys_info = {"os_name": "posix", "platform": "Darwin-16.3.0-x86_64-i386-64bit", "default_encoding": "UTF-8", "notebook_path": "/Users/rvg/miniconda2/envs/tutorial/lib/python2.7/site-packages/notebook", "sys_platform": "darwin", "sys_version": "2.7.11 |Continuum Analytics, Inc.| (default, Dec  6 2015, 18:57:58) \n[GCC 4.2.1 (Apple Inc. build 5577)]", "notebook_version": "4.0.6", "commit_source": "", "commit_hash": "", "sys_executable": "/Users/rvg/miniconda2/envs/tutorial/bin/python"};
</script>

<script src="./lstm_files/encoding.js" charset="utf-8"></script>

<script src="./lstm_files/main.min.js" charset="utf-8"></script>





<div style="position: absolute; width: 0px; height: 0px; overflow: hidden; padding: 0px; border: 0px; margin: 0px;"><div id="MathJax_Font_Test" style="position: absolute; visibility: hidden; top: 0px; left: 0px; width: auto; padding: 0px; border: 0px; margin: 0px; white-space: nowrap; text-align: left; text-indent: 0px; text-transform: none; line-height: normal; letter-spacing: normal; word-spacing: normal; font-size: 40px; font-weight: normal; font-style: normal; font-family: STIXMathJax_Main, sans-serif;"></div></div></body></html>